import React from 'react';

/**
 * Pixel art weather icons using block grids (like the snake widget)
 * Each icon is a 2D array where:
 *   0 = transparent
 *   1 = accent color (highlights: sun rays, lightning, etc.)
 *   2 = fg color (main shapes: clouds, snow)
 *   3 = muted color (subtle elements: fog, drizzle)
 */

type PixelGrid = number[][];

// ---- ICON DEFINITIONS (12x12 grid) ----

const SUN: PixelGrid = [
  [0,0,0,0,0,1,1,0,0,0,0,0],
  [0,0,1,0,0,1,1,0,0,1,0,0],
  [0,0,0,1,0,0,0,0,1,0,0,0],
  [0,0,0,0,1,1,1,1,0,0,0,0],
  [0,0,0,1,1,1,1,1,1,0,0,0],
  [1,1,0,1,1,1,1,1,1,0,1,1],
  [1,1,0,1,1,1,1,1,1,0,1,1],
  [0,0,0,1,1,1,1,1,1,0,0,0],
  [0,0,0,0,1,1,1,1,0,0,0,0],
  [0,0,1,0,0,0,0,0,1,0,0,0],
  [0,0,0,1,0,1,1,0,0,1,0,0],
  [0,0,0,0,0,1,1,0,0,0,0,0],
];

const PARTLY_CLOUDY_DAY: PixelGrid = [
  [0,0,0,0,0,0,1,0,0,0,0,0],
  [0,0,0,0,0,0,1,0,1,0,0,0],
  [0,0,0,0,0,0,0,1,0,0,0,0],
  [0,0,0,0,0,1,1,1,0,1,1,0],
  [0,0,0,0,1,1,1,1,1,0,1,0],
  [0,0,2,2,2,1,1,1,1,0,0,0],
  [0,2,2,2,2,2,2,0,0,0,0,0],
  [2,2,2,2,2,2,2,2,0,0,0,0],
  [2,2,2,2,2,2,2,2,2,0,0,0],
  [2,2,2,2,2,2,2,2,2,0,0,0],
  [0,2,2,2,2,2,2,2,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
];

const CLOUD: PixelGrid = [
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,2,2,2,0,0,0,0,0],
  [0,0,0,2,2,2,2,2,0,0,0,0],
  [0,0,2,2,2,2,2,2,2,0,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [2,2,2,2,2,2,2,2,2,2,2,0],
  [2,2,2,2,2,2,2,2,2,2,2,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
];

const OVERCAST: PixelGrid = [
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,3,3,3,0,0,0,0,0,0],
  [0,0,3,3,3,3,3,0,0,0,0,0],
  [0,3,3,3,3,3,3,3,0,0,0,0],
  [0,3,3,3,3,3,3,3,3,0,0,0],
  [0,0,0,2,2,2,3,3,3,3,0,0],
  [0,0,2,2,2,2,2,2,3,3,0,0],
  [0,2,2,2,2,2,2,2,2,0,0,0],
  [2,2,2,2,2,2,2,2,2,2,0,0],
  [2,2,2,2,2,2,2,2,2,2,0,0],
  [0,2,2,2,2,2,2,2,2,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
];

const FOG: PixelGrid = [
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,3,3,3,3,3,3,3,3,3,3,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [3,3,3,3,3,3,3,3,3,3,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,3,3,3,3,3,3,3,3,3,3,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [3,3,3,3,3,3,3,3,3,3,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,3,3,3,3,3,3,3,3,3,3,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
];

const RAIN: PixelGrid = [
  [0,0,0,0,2,2,2,0,0,0,0,0],
  [0,0,0,2,2,2,2,2,0,0,0,0],
  [0,0,2,2,2,2,2,2,2,0,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [2,2,2,2,2,2,2,2,2,2,2,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,1,0,0,1,0,0,1,0,0,1,0],
  [0,0,0,1,0,0,1,0,0,1,0,0],
  [0,1,0,0,1,0,0,1,0,0,0,0],
  [0,0,0,1,0,0,1,0,0,1,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
];

const DRIZZLE: PixelGrid = [
  [0,0,0,0,2,2,2,0,0,0,0,0],
  [0,0,0,2,2,2,2,2,0,0,0,0],
  [0,0,2,2,2,2,2,2,2,0,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [2,2,2,2,2,2,2,2,2,2,2,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,3,0,0,0,3,0,0,0,0,0],
  [0,0,0,0,0,3,0,0,0,3,0,0],
  [0,0,3,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,3,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
];

const SNOW: PixelGrid = [
  [0,0,0,0,2,2,2,0,0,0,0,0],
  [0,0,0,2,2,2,2,2,0,0,0,0],
  [0,0,2,2,2,2,2,2,2,0,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [2,2,2,2,2,2,2,2,2,2,2,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,2,0,0,2,0,0,2,0,0,2,0],
  [0,0,0,2,0,0,2,0,0,2,0,0],
  [0,2,0,0,2,0,0,2,0,0,0,0],
  [0,0,0,2,0,0,2,0,0,2,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
];

const THUNDERSTORM: PixelGrid = [
  [0,0,0,0,2,2,2,0,0,0,0,0],
  [0,0,0,2,2,2,2,2,0,0,0,0],
  [0,0,2,2,2,2,2,2,2,0,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [2,2,2,2,2,2,2,2,2,2,2,0],
  [0,0,0,0,0,1,1,0,0,0,0,0],
  [0,0,0,0,1,1,0,0,0,0,0,0],
  [0,0,0,1,1,1,1,0,0,0,0,0],
  [0,0,0,0,0,1,1,0,0,0,0,0],
  [0,0,0,0,1,1,0,0,0,0,0,0],
  [0,0,0,0,1,0,0,0,0,0,0,0],
];

const FREEZING_RAIN: PixelGrid = [
  [0,0,0,0,2,2,2,0,0,0,0,0],
  [0,0,0,2,2,2,2,2,0,0,0,0],
  [0,0,2,2,2,2,2,2,2,0,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [0,2,2,2,2,2,2,2,2,2,0,0],
  [2,2,2,2,2,2,2,2,2,2,2,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,1,0,0,2,0,0,1,0,0,2,0],
  [0,0,0,1,0,0,2,0,0,1,0,0],
  [0,2,0,0,1,0,0,2,0,0,0,0],
  [0,0,0,2,0,0,1,0,0,2,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
];

// ---- WMO CODE â†’ ICON MAPPING ----

const getPixelWeatherGrid = (code: number): PixelGrid => {
  switch (code) {
    case 0: return SUN;
    case 1: return PARTLY_CLOUDY_DAY;
    case 2: return PARTLY_CLOUDY_DAY;
    case 3: return OVERCAST;
    case 45: case 48: return FOG;
    case 51: case 53: case 55: return DRIZZLE;
    case 56: case 57: return FREEZING_RAIN;
    case 61: case 63: case 65: return RAIN;
    case 66: case 67: return FREEZING_RAIN;
    case 71: case 73: case 75: case 77: return SNOW;
    case 80: case 81: case 82: return RAIN;
    case 85: case 86: return SNOW;
    case 95: case 96: case 99: return THUNDERSTORM;
    default: return CLOUD;
  }
};

// ---- COMPONENT ----

interface PixelWeatherIconProps {
  code: number;
  isDay?: number;
  size?: number;
}

export const PixelWeatherIcon: React.FC<PixelWeatherIconProps> = ({ code, size = 6 }) => {
  const grid = getPixelWeatherGrid(code);
  const rows = grid.length;
  const cols = grid[0].length;

  return (
    <div
      className="select-none"
      style={{
        display: 'inline-grid',
        gridTemplateColumns: `repeat(${cols}, ${size}px)`,
        gridTemplateRows: `repeat(${rows}, ${size}px)`,
        gap: '1px',
      }}
    >
      {grid.flatMap((row, y) =>
        row.map((cell, x) => (
          <div
            key={`${y}-${x}`}
            style={{
              width: size,
              height: size,
              borderRadius: '1px',
              backgroundColor:
                cell === 0
                  ? 'transparent'
                  : cell === 1
                  ? 'var(--color-accent)'
                  : cell === 2
                  ? 'var(--color-fg)'
                  : 'var(--color-muted)',
            }}
          />
        ))
      )}
    </div>
  );
};
